@model BugTracker.Models.ViewModels.ProjectUsersVM;

<div class="project-main">
    <partial name="_SideNav" model="@Model.Project" />

    <div class="project-body">
        <h1>Users</h1>

        @*Filters*@
        <section style="display: flex; align-content: center; justify-content: space-between; margin: 30px 0 50px">
            <form method="get" class="user-filters-container">
                <div class="text-input-small user-search">
                    @Html.Editor("userfilter", new { HtmlAttributes = new { @class = "invisible-input", @placeholder = "Search for names, or email addresses" } })
                    <i class="fas fa-search"></i>
                </div>
                <div class="custom-select">
                    @Html.DropDownList("rolefilter", Model.ProjectRoles, "Roles", new { @class = "resizing_select user-search-dropdown" })
                    @*<select id="rolefilter" class="resizing_select user-search-dropdown" asp-items="@Model.ProjectRoles">
                            <option selected>Roles</option>
                        </select>*@
                    <select id="width_tmp_select">
                        <option id="width_tmp_option"></option>
                    </select>
                    <span class="custom-arrow"><i class="fas fa-chevron-down"></i></span>
                </div>
                <button type="submit" class="btn-filter" style="margin-left: 12px;">Filter</button>
            </form>
            <button style="padding: 7px 18px;">Add user</button>
        </section>

        @*User Table*@
        <section>
            <ejs-grid id="tblUserProject" dataSource="@Model.UserProjects" allowFiltering="true" allowSorting="true" allowPaging="true">
                <e-grid-filtersettings type="Menu"></e-grid-filtersettings>
                <e-grid-pagesettings pageSize="10"></e-grid-pagesettings>
                <e-grid-columns>
                    <e-grid-column field="UserId" headerText="Id" isPrimaryKey="true" visible="false"></e-grid-column>
                    <e-grid-column field="User.FullName" headerText="Name"></e-grid-column>
                    <e-grid-column field="User.Email" headerText="Email"></e-grid-column>
                    <e-grid-column field="ProjectRole.Name" headerText="Role"></e-grid-column>
                    <e-grid-column field="UserId" headerText="" width="100" textAlign="Center" allowSorting="false" allowFiltering="false"
                                   template="<a class='btn-table-edit' href='/Project/Edit?userId=${UserId}&projectId=${ProjectId}'><i class='fas fa-edit'></i></a>"></e-grid-column>
                </e-grid-columns>
            </ejs-grid>
        </section>
    </div>

</div>

@section Scripts{
    <script>$(document).ready(function () {
            $('#rolefilter').change(function () {
                $("#width_tmp_option").html($('#rolefilter option:selected').text());
                $(this).width($("#width_tmp_select").width() - 25);
            });
        });</script>
}